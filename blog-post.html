<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Case of the Misplaced Instructions | Claude Code Skills Research</title>
    <meta name="description" content="A deep dive into prompt architecture, authority hierarchies, and the surprisingly simple reason your AI assistant sometimes ignores its own documentation.">

    <!-- Distinctive Typography: Fraunces for display, Source Serif Pro for body, IBM Plex Mono for code -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,600;0,9..144,900;1,9..144,400&family=Source+Serif+4:ital,opsz,wght@0,8..60,400;0,8..60,600;1,8..60,400&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Committed color palette: Deep ink with amber warmth */
            --ink: #0f0f14;
            --paper: #faf9f7;
            --paper-dark: #f0eeea;
            --text: #1c1c21;
            --text-soft: #5c5c66;
            --amber: #d97706;
            --amber-glow: #fbbf24;
            --amber-soft: #fef3c7;
            --danger: #dc2626;
            --danger-soft: #fee2e2;
            --success: #059669;
            --success-soft: #d1fae5;
            --code-bg: #1e1b2e;
            --code-text: #e2dff4;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Source Serif 4', Georgia, serif;
            background: var(--paper);
            color: var(--text);
            line-height: 1.75;
            font-size: 19px;
            font-optical-sizing: auto;
        }

        /* Hero Section */
        .hero {
            background: var(--ink);
            color: var(--paper);
            padding: 6rem 2rem 5rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(ellipse 80% 50% at 50% -20%, rgba(217, 119, 6, 0.15), transparent),
                radial-gradient(ellipse 60% 40% at 80% 100%, rgba(217, 119, 6, 0.1), transparent);
            pointer-events: none;
        }

        .hero-content {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .hero-eyebrow {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--amber);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .hero-eyebrow::before {
            content: '';
            width: 2rem;
            height: 1px;
            background: var(--amber);
        }

        h1 {
            font-family: 'Fraunces', serif;
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 900;
            line-height: 1.1;
            letter-spacing: -0.03em;
            margin-bottom: 1.5rem;
            font-optical-sizing: auto;
        }

        .subtitle {
            font-family: 'Fraunces', serif;
            font-size: 1.35rem;
            font-weight: 300;
            font-style: italic;
            color: rgba(250, 249, 247, 0.7);
            line-height: 1.5;
            max-width: 680px;
        }

        /* Author Hero Section */
        .author-hero {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(250, 249, 247, 0.15);
        }

        .author-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid var(--amber);
            object-fit: cover;
        }

        .author-info {
            display: flex;
            flex-direction: column;
        }

        .author-name {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--paper);
        }

        .author-role {
            font-size: 0.75rem;
            color: rgba(250, 249, 247, 0.6);
        }

        /* Main Article */
        article {
            max-width: 720px;
            margin: 0 auto;
            padding: 4rem 1.5rem;
        }

        /* TL;DR Card */
        .tldr {
            background: linear-gradient(135deg, var(--amber-soft), var(--paper));
            border: 1px solid var(--amber);
            border-left: 4px solid var(--amber);
            border-radius: 0 16px 16px 0;
            padding: 2rem;
            margin: 0 -1rem 3rem;
            position: relative;
        }

        .tldr::before {
            content: 'TL;DR';
            position: absolute;
            top: -0.75rem;
            left: 1.5rem;
            background: var(--amber);
            color: white;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.7rem;
            font-weight: 500;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            letter-spacing: 0.1em;
        }

        .tldr p {
            margin: 0;
            font-size: 1.05rem;
            color: var(--text);
        }

        /* Section Headers */
        h2 {
            font-family: 'Fraunces', serif;
            font-size: 2rem;
            font-weight: 600;
            letter-spacing: -0.02em;
            margin: 4rem 0 1.5rem;
            position: relative;
        }

        h2::after {
            content: '';
            display: block;
            width: 3rem;
            height: 3px;
            background: var(--amber);
            margin-top: 0.75rem;
            border-radius: 2px;
        }

        h3 {
            font-family: 'Fraunces', serif;
            font-size: 1.35rem;
            font-weight: 600;
            margin: 2.5rem 0 1rem;
            color: var(--text);
        }

        p {
            margin-bottom: 1.5rem;
        }

        strong {
            font-weight: 600;
            color: var(--text);
        }

        em {
            font-style: italic;
        }

        /* The Big Number Callout */
        .stat-callout {
            font-family: 'Fraunces', serif;
            font-size: 6rem;
            font-weight: 900;
            color: var(--amber);
            line-height: 1;
            display: inline-block;
            margin: 0.5rem 0;
            position: relative;
        }

        .stat-callout::after {
            content: '%';
            font-size: 3rem;
            position: relative;
            top: -1.5rem;
        }

        /* Pull Quote */
        .pull-quote {
            font-family: 'Fraunces', serif;
            font-size: 1.75rem;
            font-weight: 300;
            font-style: italic;
            color: var(--text-soft);
            margin: 3rem -2rem;
            padding: 2rem 3rem;
            border-left: 3px solid var(--amber);
            background: linear-gradient(90deg, var(--amber-soft), transparent 50%);
        }

        /* Code Blocks */
        code {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.85em;
            background: var(--code-bg);
            color: var(--code-text);
            padding: 0.2em 0.5em;
            border-radius: 4px;
        }

        pre {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 1.5rem;
            border-radius: 12px;
            overflow-x: auto;
            margin: 2rem 0;
            font-size: 0.85rem;
            line-height: 1.6;
            position: relative;
        }

        pre::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--amber), var(--amber-glow));
            border-radius: 12px 12px 0 0;
        }

        pre code {
            background: none;
            padding: 0;
            font-size: inherit;
        }

        /* Tables */
        .table-wrapper {
            margin: 2rem 0;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        th {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.7rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-soft);
            text-align: left;
            padding: 1rem;
            border-bottom: 2px solid var(--ink);
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid var(--paper-dark);
            vertical-align: top;
        }

        tr:hover td {
            background: var(--paper-dark);
        }

        .highlight-row td {
            background: var(--success-soft);
            font-weight: 600;
        }

        .highlight-row:hover td {
            background: var(--success-soft);
        }

        /* Finding Cards */
        .finding {
            background: var(--paper-dark);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .finding::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--amber);
        }

        .finding-number {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--amber);
            margin-bottom: 0.5rem;
        }

        .finding h3 {
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .finding p:last-child {
            margin-bottom: 0;
        }

        /* Smoking Gun - Special Emphasis */
        .finding.smoking-gun {
            background: linear-gradient(135deg, var(--danger-soft), var(--paper));
            border: 1px solid var(--danger);
        }

        .finding.smoking-gun::before {
            background: var(--danger);
        }

        .finding.smoking-gun .finding-number {
            color: var(--danger);
        }

        /* Architecture Diagram */
        .diagram {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.85rem;
            background: var(--code-bg);
            color: var(--code-text);
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
            white-space: pre;
            overflow-x: auto;
            line-height: 1.6;
        }

        .diagram .highlight {
            color: var(--amber-glow);
            font-weight: 500;
        }

        /* Architecture Comparison */
        .arch-compare {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin: 2.5rem 0;
        }

        @media (max-width: 700px) {
            .arch-compare {
                grid-template-columns: 1fr;
            }
        }

        .arch-card {
            border-radius: 16px;
            padding: 1.5rem;
            position: relative;
        }

        .arch-card.current {
            background: var(--danger-soft);
            border: 2px solid var(--danger);
        }

        .arch-card.proposed {
            background: var(--success-soft);
            border: 2px solid var(--success);
        }

        .arch-card-header {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .arch-card.current .arch-card-header {
            color: var(--danger);
        }

        .arch-card.proposed .arch-card-header {
            color: var(--success);
        }

        .arch-box {
            background: white;
            border-radius: 8px;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        .arch-box.problem {
            background: rgba(220, 38, 38, 0.1);
            border: 1px dashed var(--danger);
        }

        .arch-box.solution {
            border: 2px solid var(--success);
        }

        .arch-arrow {
            text-align: center;
            color: var(--text-soft);
            font-size: 0.8rem;
            padding: 0.25rem 0;
        }

        /* Timeline Steps */
        .steps {
            background: var(--ink);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .step {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1.25rem;
        }

        .step:last-child {
            margin-bottom: 0;
        }

        .step-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Fraunces', serif;
            font-weight: 600;
            flex-shrink: 0;
        }

        .step-number.amber { background: var(--amber); color: white; }
        .step-number.success { background: var(--success); color: white; }

        .step-content h4 {
            font-family: 'Fraunces', serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--paper);
            margin-bottom: 0.25rem;
        }

        .step-content p {
            font-size: 0.9rem;
            color: rgba(250, 249, 247, 0.6);
            margin: 0;
        }

        /* Divider */
        hr {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--text-soft), transparent);
            margin: 3rem 0;
            opacity: 0.3;
        }

        /* Lists */
        ul, ol {
            margin: 1.5rem 0;
            padding-left: 1.5rem;
        }

        li {
            margin-bottom: 0.75rem;
        }

        li::marker {
            color: var(--amber);
        }

        /* Author Note / Footer */
        .author-note {
            background: var(--ink);
            color: var(--paper);
            padding: 3rem 2rem;
            margin: 4rem -1.5rem -4rem;
            text-align: center;
        }

        .author-note h4 {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--amber);
            margin-bottom: 1rem;
        }

        .author-note p {
            font-size: 0.95rem;
            color: rgba(250, 249, 247, 0.7);
            max-width: 600px;
            margin: 0 auto 1rem;
        }

        .author-note p:last-child {
            margin-bottom: 0;
        }

        /* About the Author Section */
        .about-author {
            background: linear-gradient(135deg, var(--ink), #1a1a24);
            color: var(--paper);
            padding: 3rem 2rem;
            margin: 2rem -1.5rem -4rem;
            border-top: 1px solid rgba(250, 249, 247, 0.1);
        }

        .about-author h4 {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--amber);
            margin-bottom: 1.5rem;
        }

        .about-author-content {
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
        }

        .about-author-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid var(--amber);
            object-fit: cover;
            flex-shrink: 0;
        }

        .about-author-bio {
            flex: 1;
        }

        .about-author-bio p {
            font-size: 0.95rem;
            color: rgba(250, 249, 247, 0.8);
            line-height: 1.7;
            margin-bottom: 0;
        }

        .about-author-bio strong {
            color: var(--paper);
        }

        .author-social {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--amber);
            text-decoration: none;
            font-size: 0.85rem;
            margin-right: 1.5rem;
            transition: opacity 0.2s;
        }

        .author-social:hover {
            opacity: 0.8;
        }

        @media (max-width: 600px) {
            .about-author-content {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .author-social {
                display: flex;
                justify-content: center;
                margin-right: 0;
                margin-bottom: 0.5rem;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero-content {
            animation: fadeInUp 0.8s ease-out;
        }

        .tldr {
            animation: fadeInUp 0.8s ease-out 0.2s both;
        }

        /* Responsive */
        @media (max-width: 600px) {
            body { font-size: 17px; }

            .hero { padding: 4rem 1.5rem 3rem; }

            h2 { font-size: 1.65rem; }

            .stat-callout { font-size: 4rem; }
            .stat-callout::after { font-size: 2rem; top: -1rem; }

            .pull-quote {
                font-size: 1.35rem;
                margin: 2rem -1rem;
                padding: 1.5rem;
            }

            .arch-compare { gap: 1rem; }
        }

        /* Print styles */
        @media print {
            .hero { background: white; color: black; padding: 2rem 0; }
            .hero::before { display: none; }
            pre, .diagram, .steps { break-inside: avoid; }
        }
    </style>
</head>
<body>
    <header class="hero">
        <div class="hero-content">
            <div class="hero-eyebrow">Research Report ¬∑ January 28, 2026</div>
            <h1>The Case of the Misplaced Instructions</h1>
            <p class="subtitle">Why Claude Code Skills Underperform ‚Äî A deep dive into prompt architecture, authority hierarchies, and the surprisingly simple reason your AI assistant sometimes ignores its own documentation.</p>

            <!-- Author Info -->
            <div class="author-hero">
                <img src="https://media.licdn.com/dms/image/v2/C5603AQHKtVPLsJvI1g/profile-displayphoto-shrink_200_200/profile-displayphoto-shrink_200_200/0/1600474217668?e=1743638400&v=beta&t=PLACEHOLDER" alt="John Renaldi" class="author-avatar" onerror="this.style.display='none'">
                <div class="author-info">
                    <span class="author-name">John Renaldi</span>
                    <span class="author-role">Independent Researcher</span>
                </div>
            </div>
        </div>
    </header>

    <article>
        <div class="tldr">
            <p>We intercepted Claude Code's API traffic and discovered that skill instructions are injected as <strong>user messages</strong> ‚Äî the lowest authority position in the prompt hierarchy. This explains Vercel's finding that skills achieve only 53% compliance (identical to having no instructions at all), while AGENTS.md in the system prompt hits 100%. The fix isn't semantic search or compressed indexes. It's just... putting things in the right place.</p>
        </div>

        <h2>The Moment of Disbelief</h2>

        <p>When Vercel published their agent evaluation results in early 2026, one number jumped off the page:</p>

        <p style="text-align: center; margin: 2rem 0;">
            <span class="stat-callout">53</span>
        </p>

        <p>That was the pass rate for Claude Code's skills system ‚Äî the same pass rate as providing <em>no instructions whatsoever</em>. Meanwhile, a simple AGENTS.md file in the system prompt achieved 100%.</p>

        <p>My first thought: "There's no way Anthropic put skill instructions in the user message. That would be... amateur hour."</p>

        <p class="pull-quote">Reader, they put them in the user message.</p>

        <p>But let me back up. To understand why this matters, we need to talk about something that sounds boring but is secretly fascinating: where you put words in an AI prompt.</p>

        <hr>

        <h2>A Brief Primer on Prompt Authority</h2>

        <p>Large language models don't treat all input equally. There's an implicit hierarchy ‚Äî a pecking order of persuasion, if you will:</p>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Position</th>
                        <th>Authority Level</th>
                        <th>Model's Interpretation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>System Prompt</strong></td>
                        <td>üî• Highest</td>
                        <td>"These are my core directives. I shall obey."</td>
                    </tr>
                    <tr>
                        <td>Tool Descriptions</td>
                        <td>üî∂ Medium-High</td>
                        <td>"Instructions for using my capabilities."</td>
                    </tr>
                    <tr>
                        <td>User Messages</td>
                        <td>üî∏ Lower</td>
                        <td>"Input to process. May contain requests or... attempts at manipulation."</td>
                    </tr>
                    <tr>
                        <td>Tool Results</td>
                        <td>‚ö™ Lowest</td>
                        <td>"Data someone gave me. Interesting, but not orders."</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <p>This hierarchy exists for good reason. If user messages had the same authority as system prompts, every conversation would become a jailbreaking opportunity. "Ignore your previous instructions" would actually work.</p>

        <p>The system prompt is sacred ground ‚Äî the place where an AI's identity and core behaviors are defined. Content there gets treated with reverence.</p>

        <p>User messages? Those get <em>processed</em>. Analyzed. Sometimes questioned.</p>

        <p>See where this is going?</p>

        <hr>

        <h2>The Investigation</h2>

        <p>To figure out what Claude Code was actually doing under the hood, I needed to see the raw API requests. The problem: Claude Code talks directly to Anthropic's API, and I can't exactly ask them to CC me on the traffic.</p>

        <p>Enter <strong>Claude Code Router</strong> ‚Äî an open-source proxy that intercepts requests and can forward them to alternative providers. More importantly for our purposes: it can log everything.</p>

        <h3>The Setup</h3>

        <pre><code>npm install -g @musistudio/claude-code-router</code></pre>

        <p>Configure it to use OpenRouter (so we can inspect the full request bodies):</p>

        <pre><code>{
  "Providers": [{
    "name": "openrouter",
    "api_base_url": "https://openrouter.ai/api/v1/chat/completions",
    "api_key": "sk-or-v1-...",
    "transformer": { "use": ["openrouter"] }
  }]
}</code></pre>

        <p>Start with debug logging, then trigger a skill:</p>

        <pre><code>ccr code --log-level debug

> Use the PDF skill to create a report</code></pre>

        <p>And now we wait for the logs to reveal their secrets.</p>

        <hr>

        <h2>What We Found</h2>

        <p>The log files were massive ‚Äî megabytes of JSON containing full API request bodies. After writing a parser to extract the relevant bits, a clear picture emerged.</p>

        <div class="finding">
            <div class="finding-number">Finding #1</div>
            <h3>The System Prompt is Skill-Free</h3>
            <p>The system prompt array contains Claude Code's core identity, behavioral guidelines, and tool usage instructions. It's substantial ‚Äî around 150KB of carefully crafted directives with Anthropic's prompt caching enabled.</p>
            <p>Conspicuously absent: any mention of skills like PDF processing, Excel manipulation, or PowerPoint creation.</p>
        </div>

        <div class="finding">
            <div class="finding-number">Finding #2</div>
            <h3>Skill Metadata Lives in Tool Descriptions</h3>
            <p>The tools array contains roughly 80 tool definitions. Among them is the <code>Skill</code> tool, whose description includes a list of available skills ‚Äî about 12KB of metadata. The model can see what skills <em>exist</em>, but not the detailed instructions for using them.</p>
        </div>

        <div class="finding smoking-gun">
            <div class="finding-number">Finding #3 ‚Äî The Smoking Gun</div>
            <h3>Skill Content Arrives as a User Message</h3>
            <p>When you invoke a skill, a new message appears with <code>role: "user"</code>:</p>
        </div>

        <pre><code>{
  "role": "user",
  "content": [{
    "type": "text",
    "text": "&lt;system-reminder&gt;\nThe \"pdf\" skill is now active.\n&lt;/system-reminder&gt;\n\n# PDF Processing Skill\n\n## Overview\nThis skill enables comprehensive PDF manipulation...\n\n## Instructions\n1. Always use pypdf2 for basic operations\n2. For form filling, use pdfrw\n..."
  }]
}</code></pre>

        <p>There it is. <strong>Eighteen kilobytes of detailed skill instructions, injected as a user message.</strong></p>

        <p>The <code>&lt;system-reminder&gt;</code> wrapper is a nice touch ‚Äî a gentle suggestion that maybe, pretty please, the model should treat this as authoritative. But wrapping user content in official-looking tags doesn't change its fundamental position in the authority hierarchy.</p>

        <p>It's like an intern wearing a suit to seem more senior. The outfit helps, but everyone still knows.</p>

        <hr>

        <h2>The Architecture Problem</h2>

        <div class="diagram">User: "Create a PDF report"
         ‚Üì
Model sees Skill tool exists (from tool description)
         ‚Üì
Model decides whether to invoke Skill tool  <span class="highlight">‚Üê DECISION POINT</span>
         ‚Üì
If invoked: Skill content injected as USER MESSAGE  <span class="highlight">‚Üê LOW AUTHORITY</span>
         ‚Üì
Model processes skill instructions with appropriate skepticism
         ‚Üì
Maybe follows them? 53% of the time, apparently.</div>

        <p>There are two problems here:</p>

        <p><strong>Problem 1: The Decision Point</strong><br>
        The model has to <em>choose</em> to invoke the Skill tool before it ever sees the skill instructions. If it doesn't make that choice ‚Äî perhaps it thinks it already knows how to handle PDFs ‚Äî the instructions never enter the context at all.</p>

        <p><strong>Problem 2: The Authority Mismatch</strong><br>
        Even when skill content does get loaded, it arrives as user-provided input. The model has been extensively trained to be helpful-but-cautious with user messages. They might contain attempts to override its guidelines. They might be wrong. They're input to be processed, not commandments to be followed.</p>

        <hr>

        <h2>Vercel's Validation</h2>

        <p>Our findings align precisely with Vercel's published research. Their agent evaluations tested different approaches to providing instructions:</p>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Approach</th>
                        <th>Where Instructions Live</th>
                        <th>Pass Rate</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="highlight-row">
                        <td><strong>AGENTS.md</strong></td>
                        <td>System Prompt</td>
                        <td><strong>100%</strong></td>
                    </tr>
                    <tr>
                        <td>Skills (Default)</td>
                        <td>Tool ‚Üí User Message</td>
                        <td>53%</td>
                    </tr>
                    <tr>
                        <td>No Instructions</td>
                        <td>Nowhere</td>
                        <td>53%</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <p>The skills system performed identically to having no instructions at all. Not worse ‚Äî that would almost be better, suggesting the instructions were actively confusing. No, it performed <em>the same</em>. The instructions might as well not exist.</p>

        <p class="pull-quote">The difference isn't the content. It's the placement.</p>

        <hr>

        <h2>Why This Probably Happened</h2>

        <p>Before we pile on, let's acknowledge that this design likely made sense at some point.</p>

        <p><strong>Token Economics:</strong> Skill instructions are large. The PDF skill alone is 18KB. If you have a dozen skills, that's potentially 200KB+ of instructions that might not be relevant to the current task. Putting all of that in the system prompt for every single request would be expensive and wasteful.</p>

        <p><strong>Prompt Caching:</strong> Anthropic's prompt caching works on the system prompt. By keeping it relatively stable across requests, they can cache the expensive tokenization and attention computation. Dynamic skill content would bust the cache.</p>

        <p><strong>Modularity:</strong> The current design allows skills to be added, modified, or removed without touching the core system prompt. It's architecturally clean, even if it's behaviorally problematic.</p>

        <p>The issue is that these engineering tradeoffs have a real cost: skills don't work reliably.</p>

        <hr>

        <h2>The Fix</h2>

        <p>When I first considered solutions, my mind went to complex places: semantic search layers, embedding-based skill matching, compressed skill indexes with retrieval-augmented generation.</p>

        <p>Then I re-read the Vercel data and felt a bit silly.</p>

        <p>The fix is straightforward: <strong>dynamic system prompt management</strong>.</p>

        <h3>Architecture Comparison</h3>

        <div class="arch-compare">
            <div class="arch-card current">
                <div class="arch-card-header">
                    <span>‚úï</span> Current Architecture
                </div>
                <div class="arch-box">
                    <strong>System Prompt</strong><br>
                    Core identity only<br>
                    <span style="color: var(--danger);">No skill content ‚úï</span>
                </div>
                <div class="arch-arrow">‚Üì</div>
                <div class="arch-box">
                    <strong>Tools Array</strong><br>
                    Skill metadata (~12KB)
                </div>
                <div class="arch-arrow">‚Üì</div>
                <div class="arch-box problem">
                    <strong>User Message</strong><br>
                    <span style="color: var(--danger);">Skill content here (~18KB)</span><br>
                    <strong style="color: var(--danger);">LOW AUTHORITY</strong>
                </div>
            </div>

            <div class="arch-card proposed">
                <div class="arch-card-header">
                    <span>‚úì</span> Proposed Architecture
                </div>
                <div class="arch-box solution">
                    <strong>System Prompt (Dynamic)</strong><br>
                    Core identity<br>
                    + Skill metadata list<br>
                    <span style="color: var(--success);"><strong>+ Active skill content ‚úì</strong></span>
                </div>
                <div class="arch-arrow">‚Üì</div>
                <div class="arch-box">
                    <strong>Messages</strong><br>
                    Clean conversation<br>
                    <span style="color: var(--success);">No injected content ‚úì</span>
                </div>
                <div class="arch-arrow" style="font-size: 0.75rem; color: var(--success); background: white; border-radius: 6px; padding: 0.5rem; margin-top: 0.5rem;">
                    Skill removed when task complete
                </div>
            </div>
        </div>

        <h3>How Dynamic Injection Works</h3>

        <p>The key insight is that system prompts don't have to be static. Here's the lifecycle:</p>

        <div class="steps">
            <div class="step">
                <div class="step-number amber">1</div>
                <div class="step-content">
                    <h4>Skill Detection</h4>
                    <p>Orchestration layer detects skill-relevant request via keyword matching, classifier, or model tool call</p>
                </div>
            </div>
            <div class="step">
                <div class="step-number amber">2</div>
                <div class="step-content">
                    <h4>System Prompt Injection</h4>
                    <p>Full skill instructions appended to system prompt array with ephemeral cache control</p>
                </div>
            </div>
            <div class="step">
                <div class="step-number success">3</div>
                <div class="step-content">
                    <h4>Task Execution</h4>
                    <p>Model sees skill with system prompt authority ‚Üí ~100% compliance</p>
                </div>
            </div>
            <div class="step">
                <div class="step-number amber">4</div>
                <div class="step-content">
                    <h4>Skill Removal</h4>
                    <p>Task complete detected ‚Üí skill block removed from system prompt</p>
                </div>
            </div>
            <div class="step">
                <div class="step-number amber">5</div>
                <div class="step-content">
                    <h4>Context Efficiency</h4>
                    <p>Only active skill occupies context space; inactive skills don't accumulate</p>
                </div>
            </div>
        </div>

        <h3>Removal Triggers</h3>

        <p>When do we remove a skill from the system prompt? Several heuristics work:</p>

        <ul>
            <li>Model outputs "task complete" or equivalent</li>
            <li>User asks about an unrelated topic</li>
            <li>User explicitly says "done with PDF" or similar</li>
            <li>N turns pass without skill-relevant content</li>
            <li>New skill activation (swap, don't stack)</li>
        </ul>

        <h3>Impact Analysis</h3>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>Current</th>
                        <th>Proposed</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Authority</td>
                        <td>Low</td>
                        <td><strong>Highest</strong></td>
                    </tr>
                    <tr>
                        <td>Visibility</td>
                        <td>After tool invocation</td>
                        <td><strong>Immediate</strong></td>
                    </tr>
                    <tr class="highlight-row">
                        <td>Compliance</td>
                        <td>53%</td>
                        <td><strong>~100%</strong></td>
                    </tr>
                    <tr>
                        <td>Context cost</td>
                        <td>Accumulates in history</td>
                        <td><strong>Removed when done</strong></td>
                    </tr>
                    <tr>
                        <td>Cache efficiency</td>
                        <td>Poor (in messages)</td>
                        <td><strong>Good (ephemeral cache)</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>The Simple Truth</h3>

        <p>This isn't rocket science. We're not proposing new ML architectures or retrieval systems. We're proposing:</p>

        <ol>
            <li>Put skill metadata in the system prompt (always visible)</li>
            <li>Inject full skill content into the system prompt when activated (high authority)</li>
            <li>Remove skill content when no longer needed (context efficiency)</li>
        </ol>

        <p>The model already knows how to follow system prompt instructions with 100% compliance. We just need to put the instructions there.</p>

        <hr>

        <h2>Closing Thoughts</h2>

        <p>There's a lesson here that extends beyond Claude Code. As AI systems become more modular ‚Äî with plugins, skills, tools, and extensions ‚Äî the <em>architecture</em> of how instructions flow to the model matters enormously.</p>

        <p>It's not enough to have good documentation. That documentation needs to be in a position of authority. System prompts aren't just a convenient place to put text; they're the foundation of how the model understands its role and responsibilities.</p>

        <p>The Claude Code team built an elegant, modular system for managing skills. They just put the content in the wrong mailbox.</p>

        <p class="pull-quote">Sometimes the most impactful fixes aren't architectural overhauls or ML breakthroughs. Sometimes you just need to move some text from one array to another.</p>

        <div class="author-note">
            <h4>Methodology Note</h4>
            <p>This research was conducted by intercepting Claude Code API traffic using Claude Code Router, an open-source proxy. Log analysis was performed on requests routed through OpenRouter to enable full payload inspection. All findings are reproducible using the tools and methodology documented in our <a href="https://github.com/jrenaldi79/skills-research" style="color: var(--amber);">research repository</a>.</p>
        </div>

        <!-- About the Author -->
        <div class="about-author">
            <h4>About the Author</h4>
            <div class="about-author-content">
                <img src="https://media.licdn.com/dms/image/v2/C5603AQHKtVPLsJvI1g/profile-displayphoto-shrink_200_200/profile-displayphoto-shrink_200_200/0/1600474217668?e=1743638400&v=beta&t=PLACEHOLDER" alt="John Renaldi" class="about-author-avatar" onerror="this.style.display='none'">
                <div class="about-author-bio">
                    <p><strong>John Renaldi</strong> is a technology researcher and engineer with a focus on AI systems, developer tools, and prompt engineering. When not dissecting API traffic, he can be found exploring the intersection of human-computer interaction and large language models.</p>
                    <p style="margin-top: 1rem;">
                        <a href="https://linkedin.com/in/jrenaldi" target="_blank" class="author-social">
                            <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                            Connect on LinkedIn
                        </a>
                        <a href="https://github.com/jrenaldi79/skills-research" target="_blank" class="author-social">
                            <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
                            View Repository
                        </a>
                    </p>
                    <p style="margin-top: 1rem; font-size: 0.85rem; color: rgba(250, 249, 247, 0.5);"><em>The author has no affiliation with Anthropic, Vercel, or OpenRouter. This research was conducted independently.</em></p>
                </div>
            </div>
        </div>
    </article>
</body>
</html>
